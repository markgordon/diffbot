<launch>
  <!-- Arguments -->
	<arg name="rviz_cfg"                default="$(find rtabmap_ros)/launch/config/turtlebot_navigation.rviz" />
	<arg name="positioning_sensor"			default="lidar" />
	<arg name="rtabmap_args"				default="" />
	<arg name="database_path"				default="" />
	<arg name="scan_topic"  default="diffbot/scan"/>
	<arg name="rgb_topic"					default="/zed/zed_node/rgb/image_rect_color" />
	<arg name="depth_topic"					default="/zed/zed_node/depth/depth_registered" />
	<arg name="camera_info_topic"			default="/zed/zed_node/rgb/camera_info" />
	<arg name="depth_camera_info_topic"		default="/zed/zed_node/depth/camera_info" />

	<arg name="subscribe_scan"				default="true" />
	<arg name="subscribe_rgbd"				default="false" />
	<arg name="rgbd_sync"					default="false" />
	<group  if="$(eval positioning_sensor == 'lidar')" >
		<remap from="scan"    to="/scan"/>

	    <node pkg="rtabmap_ros" type="rtabmap" name="rtabmap" output="screen" args="-d">
			<param name="subscribe_scan"   value="true"/>
			<param name="subscribe_rgb"    value="false"/>
			<param name="subscribe_depth"  value="false"/>
			<param name="frame_id"         value="base_link"/>
			<param name="odom_frame_id"    value="odom"/>
			<param name="wait_for_transform_duration"  value="1"/>
			<param name="odom_tf_linear_variance"  value="0.01"/>
			<param name="odom_tf_angular_variance" value="0.05"/>

			<param name="Reg/Strategy"              value="1"/>    <!-- 1 for lidar -->
			<param name="Reg/Force3DoF"             value="true"/> <!-- 2d slam -->
			<param name="RGBD/NeighborLinkRefining" value="true"/> <!-- odometry correction with scans -->
			<remap from="scan" to="$(arg scan_topic)"/>
			<remap from="odom" to="/diffbot/mobile_base_controller/odom"/>
			
	    </node>
	</group>


</launch>
